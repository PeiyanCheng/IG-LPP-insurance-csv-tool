<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Insurance Illustration → LPP standardized CSV</title>

<!-- Beautiful font for title -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body {
  background:#f4f6f8;
  font-family:Inter, Arial, sans-serif;
  margin:0;
  color:#333;
}

.page-container {
  max-width:1320px;
  margin:auto;
  padding:32px;
  background:#fff;
}

/* ===== Title ===== */

.page-title {
  text-align:center;
  font-family:'Playfair Display', serif;
  font-size:36px;
  font-weight:700;
  margin-bottom:6px;
}

.page-subtitle {
  text-align:center;
  font-size:14px;
  color:#666;
  margin-bottom:32px;
}

/* ===== Actions ===== */

.action-bar {
  display:flex;
  justify-content:center;
  gap:14px;
  margin-bottom:24px;
  flex-wrap:wrap;
}

.btn {
  padding:12px 20px;
  font-size:14px;
  font-weight:600;
  border-radius:8px;
  cursor:pointer;
}

.btn-upload {
  background:#e8f5e9;
  border:1px solid #66bb6a;
  color:#2e7d32;
}

.btn-primary {
  background:#1976d2;
  border:none;
  color:#fff;
}

.file-input { display:none; }

/* ===== File Tabs ===== */

.file-tabs {
  display:flex;
  gap:8px;
  margin-bottom:20px;
  flex-wrap:wrap;
}

.file-tab {
  padding:6px 14px;
  border-radius:16px;
  cursor:pointer;
  font-size:12px;
  background:#e0e0e0;
}

.file-tab.active {
  background:#1976d2;
  color:#fff;
}

/* ===== Cards ===== */

.card {
  border-radius:12px;
  padding:16px;
  margin-bottom:24px;
  box-shadow:0 2px 6px rgba(0,0,0,0.06);
}

.card-blue { background:#f1f7ff; }
.card-green { background:#f1fbf4; }
.card-gray { background:#f5f6f7; }
.card-yellow { background:#fff8e1; }

.card h3 {
  margin-top:0;
  font-size:16px;
  font-weight:600;
}

/* ===== Tables ===== */

table {
  border-collapse:collapse;
  font-size:12px;
  background:#fff;
}

th, td {
  border:1px solid #ccc;
  padding:4px;
  white-space:nowrap;
}

.highlight { background:#fff3cd; }

.table-scroll {
  max-height:320px;
  overflow:auto;
  border:1px solid #ccc;
  border-radius:6px;
}

/* Sticky header */
.table-scroll thead th {
  position:sticky;
  top:0;
  background:#f1f3f6;
  z-index:3;
}

/* Freeze first column for original */
.freeze-first-col th:first-child,
.freeze-first-col td:first-child {
  position:sticky;
  left:0;
  background:#f9fafc;
  z-index:2;
}

.freeze-first-col thead th:first-child {
  z-index:4;
}

/* ===== Rules ===== */

.rule-input {
  width:520px;
  padding:6px;
  border-radius:6px;
  border:1px solid #bbb;
}

.rule-hint {
  font-size:12px;
  color:#555;
  margin-bottom:10px;
}

/* ===== Explanation ===== */

.log {
  background:#fff;
  border:1px solid #ccc;
  padding:8px;
  margin:6px 0;
  font-size:12px;
  border-radius:6px;
}
</style>
</head>

<body>
<div class="page-container">

<div class="page-title">
  Insurance Illustration → LPP standardized CSV
</div>
<div class="page-subtitle">
  Upload insurance illustration files, review standardized output, then download LPP-ready CSVs
</div>

<div class="action-bar">
  <label class="btn btn-upload">
    Upload illustration files
    <input type="file" id="fileInput" class="file-input" multiple onchange="processFiles()">
  </label>

  <button class="btn btn-primary" onclick="downloadCurrent()">Download current CSV</button>
  <button class="btn btn-primary" onclick="downloadAll()">Download all CSVs</button>
</div>

<div id="fileTabs" class="file-tabs"></div>

<!-- ===== Side-by-side Preview ===== -->

<div style="display:flex; gap:24px;">
  <div style="width:50%;" class="card card-blue">
    <h3>Illustration review</h3>
    <div id="originalPreview"></div>
  </div>

  <div style="width:50%;" class="card card-green">
    <h3>LPP standardized preview</h3>
    <div id="csvPreview"></div>
  </div>
</div>

<!-- ===== Rules ===== -->

<div class="card card-gray">
  <h3>Field matching rules</h3>
  <div class="rule-hint">
    • Use <b>|</b> to add alternative keywords (OR)<br>
    • All words in one group must appear in the column header (AND)
  </div>

  <table id="ruleTable">
    <tr>
      <th>LPP field</th>
      <th>Keywords</th>
    </tr>
  </table>
</div>

<!-- ===== Explanation ===== -->

<div class="card card-yellow">
  <h3>Matching explanation</h3>
  <div id="explainArea"></div>
</div>

<!-- ===== JS (unchanged, keep your current JS here) ===== -->
<script>
/* ⚠️ KEEP YOUR EXISTING FINAL v2.5 JS HERE – NO LOGIC CHANGE */
</script>

</div>
</body>
</html>
